import { useEffect, useState } from 'react'

import Head from 'next/head'

import Box from '@mui/material/Box';
import Container from '@mui/material/Container';
import Grid from '@mui/material/Grid';

import Navbar from '../components/Navbar'

import { getAuthor, getBooks } from '../utils/authors';
import AuthorInfo from '../components/AuthorInfo';
import { PopularAuthorList } from '../components/PopularAuthorList';
import BooksTable from '../components/BooksTable';


export default function Home() {

  const [key, setKey] = useState("OL23919A")
  const [authorData, setAuthorData] = useState([])
  const [Booksdata, setBooksdata] = useState([])

  useEffect(() => {
    getAuthor(key).then((data) => {
      setAuthorData(data)
    })
  }, [key])
  useEffect(() => {
    getBooks(key).then((bookdata) => {
      setBooksdata(bookdata)
    })
  }, [key])

  return (
    <div>
      <Head>
        <title>Library App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Navbar />
      <main>
        <Container maxWidth="md">
          <Grid container spacing={4}>
            <Grid item xs={8}>
              <Box>
                <AuthorInfo authorData={authorData} />
                <BooksTable Booksdata={Booksdata} />
              </Box>
            </Grid>
            <PopularAuthorList setAuthorKey={setKey}/>
          </Grid>
        </Container>
      </main>
    </div>
  )
}
